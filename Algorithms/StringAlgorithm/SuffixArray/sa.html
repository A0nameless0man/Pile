<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>define _CRT_SECURE_NO_WARNINGS</title>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family:  'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 16px;
                line-height: 1.6;
            }
        </style>
        
        
    </head>
    <body class="vscode-light">
        <pre><code class="language-cpp"><div><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ULL  unsigned long long</span>
<span class="hljs-keyword">const</span> ULL MAX_N = <span class="hljs-number">10000007</span>;
<span class="hljs-keyword">char</span> s[MAX_N];
ULL sa[MAX_N];
ULL rnk[MAX_N];
ULL b[MAX_N];
ULL sum[MAX_N];
ULL h[MAX_N];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">c</span><span class="hljs-params">(ULL i, ULL j)</span> </span>{ <span class="hljs-keyword">return</span> s[i] &lt; s[j]; };
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buildSa</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
    ULL n = <span class="hljs-built_in">strlen</span>(s);
    <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>; i &lt; n; i++)
    {
        sa[i] = i;
    }
    <span class="hljs-built_in">std</span>::sort(sa, sa + n, c);
    rnk[sa[<span class="hljs-number">0</span>]] = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>; i &lt; n; i++)
    {
        rnk[sa[i]] = rnk[sa[i - <span class="hljs-number">1</span>]];
        <span class="hljs-keyword">if</span>(c(sa[i - <span class="hljs-number">1</span>], sa[i]))
        {
            rnk[sa[i]]++;
        }
    }
    <span class="hljs-keyword">for</span> (ULL k = <span class="hljs-number">1</span>; rnk[sa[n - <span class="hljs-number">1</span>]] &lt; n - <span class="hljs-number">1</span>; k &lt;&lt;= <span class="hljs-number">1</span>)
    {
        ULL m = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (ULL i = n - k; i &lt; n; i++)
        {
            b[m++] = i;
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)
        {
            <span class="hljs-keyword">if</span> (sa[i] &gt;= k)
            {
                b[m++] = sa[i] - k;
            }
        }
        <span class="hljs-built_in">memset</span>(sum, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(sum));
        <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>; i &lt; n; i++)
        {
            sum[rnk[i]]++;
        }
        <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">1</span>; i &lt; n; i++)
        {
            sum[i] += sum[i - <span class="hljs-number">1</span>];
        }
        <span class="hljs-keyword">for</span> (ULL i = n - <span class="hljs-number">1</span>; ~i; i--)
        {
            sa[--sum[rnk[b[i]]]] = b[i];
        }
        <span class="hljs-built_in">std</span>::swap(sum, rnk);
        rnk[sa[<span class="hljs-number">0</span>]] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">1</span>; i &lt; n; i++)
        {
            rnk[sa[i]] = rnk[sa[i - <span class="hljs-number">1</span>]];
            <span class="hljs-keyword">if</span>(sum[sa[i - <span class="hljs-number">1</span>]] &lt; sum[sa[i]] || sa[i - <span class="hljs-number">1</span>] + k &gt;= n || sum[sa[i - <span class="hljs-number">1</span>] + k] &lt; sum[sa[i] + k])
            {
                rnk[sa[i]]++;
            }
        }
    }
    <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt; n; i++)
    {
        <span class="hljs-keyword">if</span> (j)
        {
            j--;
        }
        <span class="hljs-keyword">if</span> (rnk[i] == n - <span class="hljs-number">1</span>)
        {
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">while</span> (s[i + j] == s[sa[rnk[i] + <span class="hljs-number">1</span>] + j])
        {
            j++;
        }
        h[rnk[i]] = j;
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%s"</span>, s);
    buildSa();
    ULL n = <span class="hljs-built_in">strlen</span>(s);
    <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>; i &lt; n; i++)
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%llu "</span>, sa[i] + <span class="hljs-number">1</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">for</span> (ULL i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++)
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%llu "</span>, h[i]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</div></code></pre>

    </body>
    </html>